<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Gesti√≥n operativa | Afiliaci√≥n ¬∑ Reafiliaci√≥n ¬∑ Reactivaci√≥n</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 20px;
  }

  label {
    font-weight: bold;
    display: block;
    margin-top: 12px;
  }

  select, input, button {
    margin-top: 6px;
    padding: 6px;
    width: 280px;
  }

  .bloque {
    margin-top: 20px;
    padding: 12px;
    border-radius: 6px;
    display: none;
  }

  #resultado {
    margin-top: 20px;
    padding: 12px;
    border: 1px solid #ccc;
    border-radius: 6px;
  }

  .ok { background: #e8f5e9; }
  .warn { background: #fff3cd; }
  .error { background: #f8d7da; }
</style>
</head>

<body>

<h2>Identificaci√≥n del tr√°mite</h2>

<!-- ESTADO -->
<label>üü¢ Estado del afiliado</label>
<select id="estado" onchange="toggleDatosBaja()">
  <option value="">Seleccionar</option>
  <option value="activo">Activo</option>
  <option value="baja">Baja</option>
</select>

<!-- DATOS DE BAJA -->
<div id="datosBaja" style="display:none">

  <label>üìÖ Fecha de baja</label>
  <input type="date" id="fechaBaja">

  <label>üéÇ Edad del titular</label>
  <input type="number" id="edad" min="0">

  <label>üè• Opci√≥n SSS</label>
  <select id="opcionSSS">
    <option value="">Seleccionar</option>
    <option value="parque">Parque Salud</option>
    <option value="otra">Otra obra social</option>
  </select>

</div>

<button onclick="determinarTramite()">Determinar tr√°mite</button>

<!-- RESULTADO -->
<div id="resultado" style="display:none"></div>

<!-- BLOQUES EXPLICATIVOS -->
<div id="reactivacion" class="bloque ok">
  üîÑ <strong>Reactivaci√≥n</strong><br>
  Gesti√≥n administrativa.<br>
  ‚ö†Ô∏è Controlar deuda. Crear ticket. No cargar ficha comercial.
</div>

<div id="reafiliacion" class="bloque ok">
  üîÅ <strong>Reafiliaci√≥n</strong><br>
  Gesti√≥n comercial.<br>
  Control de deuda seg√∫n procedimiento vigente.
</div>

<div id="afiliacion" class="bloque ok">
  üü£ <strong>Venta / Traspaso</strong><br>
  Gesti√≥n comercial.<br>
  Control de deuda si fue ex afiliado.
</div>

<div id="noGestionable" class="bloque error">
  ‚ùå <strong>Tr√°mite no gestionable</strong><br>
  ‚ö†Ô∏è Figura activo en otra obra social.
</div>

<script>
// Mostrar / ocultar datos de baja
function toggleDatosBaja() {
  const estado = document.getElementById("estado").value;
  const datos = document.getElementById("datosBaja");

  if (estado === "baja") {
    datos.style.display = "block";
  } else {
    datos.style.display = "none";
    document.getElementById("fechaBaja").value = "";
    document.getElementById("edad").value = "";
    document.getElementById("opcionSSS").value = "";
  }
}

// Calcular meses entre fechas
function mesesEntreFechas(inicio, fin) {
  const f1 = new Date(inicio);
  const f2 = new Date(fin);

  let meses = (f2.getFullYear() - f1.getFullYear()) * 12;
  meses += f2.getMonth() - f1.getMonth();

  if (f2.getDate() < f1.getDate()) meses--;

  return meses;
}

// Determinar tr√°mite
function determinarTramite() {
  const estado = document.getElementById("estado").value;
  const resultado = document.getElementById("resultado");

  const bloques = ["reactivacion","reafiliacion","afiliacion","noGestionable"];
  bloques.forEach(id => document.getElementById(id).style.display = "none");

  resultado.style.display = "block";

  if (!estado) {
    resultado.innerHTML = "‚ö†Ô∏è Seleccion√° el estado del afiliado.";
    resultado.className = "warn";
    return;
  }

  // ACTIVO
  if (estado === "activo") {
    resultado.innerHTML = `
      <strong>Afiliado activo</strong><br>
      ‚ö†Ô∏è No corresponde venta ni reafiliaci√≥n.
    `;
    resultado.className = "warn";
    return;
  }

  // BAJA
  const fechaBaja = document.getElementById("fechaBaja").value;
  const edad = parseInt(document.getElementById("edad").value);
  const opcion = document.getElementById("opcionSSS").value;

  if (!fechaBaja || isNaN(edad) || !opcion) {
    resultado.innerHTML = "‚ö†Ô∏è Complet√° todos los datos de la baja.";
    resultado.className = "warn";
    return;
  }

  const mesesBaja = mesesEntreFechas(fechaBaja, new Date());

  // NO GESTIONABLE
  if (opcion === "otra" && mesesBaja < 6) {
    resultado.innerHTML = "<strong>Resultado del an√°lisis</strong>";
    resultado.className = "error";
    document.getElementById("noGestionable").style.display = "block";
    return;
  }

  // REACTIVACI√ìN
  if (edad >= 50 || mesesBaja <= 6) {
    resultado.innerHTML = "<strong>Resultado del an√°lisis</strong>";
    resultado.className = "ok";
    document.getElementById("reactivacion").style.display = "block";
    return;
  }

  // REAFILIACI√ìN
  if (opcion === "parque") {
    resultado.innerHTML = "<strong>Resultado del an√°lisis</strong>";
    resultado.className = "ok";
    document.getElementById("reafiliacion").style.display = "block";
    return;
  }

  // VENTA / TRASPASO
  resultado.innerHTML = "<strong>Resultado del an√°lisis</strong>";
  resultado.className = "ok";
  document.getElementById("afiliacion").style.display = "block";
}
</script>

</body>
</html>
